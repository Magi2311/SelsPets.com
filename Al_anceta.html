<!-- –ö—Ä—ä–≥—ä–ª –±—É—Ç–æ–Ω –∑–∞ –æ—Ç–≤–∞—Ä—è–Ω–µ –Ω–∞ –∞–Ω–∫–µ—Ç–∞—Ç–∞ -->
<div id="ai-toggle-btn" title="AI –ø—Ä–µ–ø–æ—Ä—ä–∫–∞">
  üêæ
</div>

<!-- –ü–∞–Ω–µ–ª —Å –∞–Ω–∫–µ—Ç–∞—Ç–∞ -->
<div id="ai-survey-panel" class="survey-panel">
  <h3 style="margin: 10px;">–ö–∞–∫–≤–æ –∂–∏–≤–æ—Ç–Ω–æ –µ –ø–æ–¥—Ö–æ–¥—è—â–æ –∑–∞ —Ç–µ–±?</h3>
  <form id="pet-survey-form">

    <!-- –ñ–∏–ª–∏—â–Ω–∞ —Å—Ä–µ–¥–∞ -->
    <fieldset>
      <legend>–ñ–∏–ª–∏—â–Ω–∞ —Å—Ä–µ–¥–∞</legend>
      <label>–ñ–∏–≤–µ–µ—à –≤:
        <select name="apartment">
          <option value="2">–ö—ä—â–∞ —Å –¥–≤–æ—Ä</option>
          <option value="1">–ê–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç —Å —Ç–µ—Ä–∞—Å–∞</option>
          <option value="0">–ê–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç –±–µ–∑ —Ç–µ—Ä–∞—Å–∞</option>
        </select>
      </label>
      <label>–ò–º–∞—à –ª–∏ –¥–µ—Ü–∞?
        <select name="children">
          <option value="1">–î–∞</option>
          <option value="0">–ù–µ</option>
        </select>
      </label>
      <label>–ò–º–∞—à –ª–∏ –∞–ª–µ—Ä–≥–∏–∏?
        <select name="allergy">
          <option value="1">–î–∞</option>
          <option value="0">–ù–µ</option>
        </select>
      </label>
      <label>–î–æ–º—ä—Ç —Ç–∏ –µ:
        <select name="noise_level">
          <option value="0">–°–ø–æ–∫–æ–µ–Ω –∏ —Ç–∏—Ö</option>
          <option value="1">–®—É–º–µ–Ω (–¥–µ—Ü–∞, —Ç–µ–ª–µ–≤–∏–∑–∏—è, –≥–æ—Å—Ç–∏)</option>
        </select>
      </label>
    </fieldset>

    <!-- –†–µ—Å—É—Ä—Å–∏ –∏ –≤—Ä–µ–º–µ -->
    <fieldset>
      <legend>–í—Ä–µ–º–µ –∏ –≤—ä–∑–º–æ–∂–Ω–æ—Å—Ç–∏</legend>
      <label>–ö–æ–ª–∫–æ –≤—Ä–µ–º–µ –Ω–∞ –¥–µ–Ω –º–æ–∂–µ—à –¥–∞ –æ—Ç–¥–µ–ª—è—à?
        <select name="time">
          <option value="0">–ü–æ–¥ 30 –º–∏–Ω—É—Ç–∏</option>
          <option value="1">30-60 –º–∏–Ω—É—Ç–∏</option>
          <option value="2">–ù–∞–¥ 1 —á–∞—Å</option>
        </select>
      </label>
      <label>–ö–æ–ª–∫–æ —á–µ—Å—Ç–æ –ø—ä—Ç—É–≤–∞—à?
        <select name="travel_often">
          <option value="0">–†—è–¥–∫–æ</option>
          <option value="1">–ü–æ–Ω—è–∫–æ–≥–∞</option>
          <option value="2">–ß–µ—Å—Ç–æ</option>
        </select>
      </label>
      <label>–ë—é–¥–∂–µ—Ç –∑–∞ –º–µ—Å–µ—á–Ω–∏ –≥—Ä–∏–∂–∏:
        <select name="budget">
          <option value="0">–ü–æ–¥ 50 –ª–≤</option>
          <option value="1">50‚Äì150 –ª–≤</option>
          <option value="2">–ù–∞–¥ 150 –ª–≤</option>
        </select>
      </label>
    </fieldset>

    <!-- üêæ –ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞–Ω–∏—è –∏ –æ–ø–∏—Ç -->
    <fieldset>
      <legend>–õ–∏—á–Ω–∏ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–Ω–∏—è</legend>
      <label>–ò–º–∞–ª –ª–∏ —Å–∏ –∂–∏–≤–æ—Ç–Ω–∏ –¥–æ—Å–µ–≥–∞?
        <select name="experience">
          <option value="2">–î–∞, –¥—ä–ª–≥–æ –≤—Ä–µ–º–µ</option>
          <option value="1">–î–∞, –∑–∞ –∫—Ä–∞—Ç–∫–æ</option>
          <option value="0">–ù–µ</option>
        </select>
      </label>
      <label>–ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞—à –∂–∏–≤–æ—Ç–Ω–æ:
        <select name="social">
          <option value="0">–°–ø–æ–∫–æ–π–Ω–æ, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ</option>
          <option value="1">–°–æ—Ü–∏–∞–ª–Ω–æ –∏ –≥—É—à–ª–∏–≤–æ</option>
        </select>
      </label>
      <label>–•–∞—Ä–µ—Å–≤–∞—à –ª–∏ –∂–∏–≤–æ—Ç–Ω–∏ —Å –∫–æ–∑–∏–Ω–∞?
        <select name="furry">
          <option value="1">–î–∞</option>
          <option value="0">–ù–µ</option>
        </select>
      </label>
      <label>–ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞—à –∞–∫—Ç–∏–≤–µ–Ω –ª—é–±–∏–º–µ—Ü?
        <select name="active">
          <option value="1">–î–∞</option>
          <option value="0">–ù–µ</option>
        </select>
      </label>
      <label>–ö–∞–∫—ä–≤ —Ä–∞–∑–º–µ—Ä –∂–∏–≤–æ—Ç–Ω–æ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—à?
        <select name="size">
          <option value="0">–ú–∞–ª–∫–æ (–¥–æ 5 –∫–≥)</option>
          <option value="1">–°—Ä–µ–¥–Ω–æ (5‚Äì20 –∫–≥)</option>
          <option value="2">–ì–æ–ª—è–º–æ (–Ω–∞–¥ 20 –∫–≥)</option>
        </select>
      </label>
    </fieldset>
    <div class="result" style="display: flex; flex-direction: row; gap:10px">
    <button type="submit">–í–∏–∂ –ø—Ä–µ–ø–æ—Ä—ä–∫–∞</button>
    <button type="button" id="reset-btn" style="background-color:red;">–ò–∑—á–∏—Å—Ç–∏</button>
</div>

<!-- –¢—É–∫ —â–µ —Å–µ –ø–æ—è–≤—è–≤–∞ –ø—Ä–µ–ø–æ—Ä—ä–∫–∞—Ç–∞ -->
<div id="survey-result" style="margin-top: 15px;
 padding: 10px; background-color: #fffbe0; 
 border: 1px solid #ccc; border-radius: 5px; 
 max-height: 250px; 
 overflow-y: auto; font-size: 14px;">
 </div>
</form>
<!-- <div>{% if result %}
    <p>–ü—Ä–µ–ø–æ—Ä—ä—á–≤–∞–º–µ —Ç–∏: {{ result }}</p>
    {% endif %}
</div>-->  
</div>

<style>
  /* –ú–æ–¥–∞–ª–µ–Ω –ø—Ä–æ–∑–æ—Ä–µ—Ü */
.modal {
  position: fixed;
  z-index: 2000;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgba(0,0,0,0.5); /* —Ç—ä–º–µ–Ω —Ñ–æ–Ω */
  display: flex;
  justify-content: center;
  align-items: center;
}

.modal-content {
  background-color: #fff;
  padding: 20px;
  border-radius: 8px;
  width: 90%;
  max-width: 600px;
  box-shadow: 0 0 15px rgba(0,0,0,0.3);
  position: relative;
}

.close {
  color: #aaa;
  position: absolute;
  top: 12px;
  right: 20px;
  font-size: 28px;
  font-weight: bold;
  cursor: pointer;
}

.close:hover {
  color: #000;
}

/* –ö—Ä—ä–≥—ä–ª –±—É—Ç–æ–Ω –∑–∞ –æ—Ç–≤–∞—Ä—è–Ω–µ */
#ai-toggle-btn {
  position: fixed;
  bottom: 30px; /* üìç –û—Å—Ç–∞–≤–∞ –¥–æ–ª—É */
  right: 30px;
  background-color: #ffae00;
  color: white;
  border-radius: 50%;
  width: 75px;
  height: 75px;
  font-size: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  box-shadow: 0 0 10px gray;
  z-index: 1000;
}
#ai-toggle-btn:hover {
  background-color: #ff9100;
}

/* –ü–∞–Ω–µ–ª —Å –∞–Ω–∫–µ—Ç–∞—Ç–∞ */
.survey-panel {
    position: fixed;
    /* bottom: 120px; */
    right: -400px;
    /* height: 800px; */
    /* width: 260px; */
    max-height: 765px;
    top: 80px;
    background: antiquewhite;
    border: 2px solid #ccc;
    padding: 15px;
    box-shadow: -4px 0 10px rgba(0, 0, 0, 0.2);
    transition: right 0.5s ease;
    z-index: 999;
    border-radius: 10px 0 0 10px;
    overflow-y: auto;
}
.survey-panel.show {
  right: 0;
}
.h3{
        margin: 10px 0;
}
@media (max-width: 600px) {
  .survey-panel {
    width: 90vw;
    right: -95vw;
    bottom: 100px; /* üì± –ú–∞–ª–∫–æ –Ω–∞–¥ –º–æ–±–∏–ª–Ω–∏—è –±—É—Ç–æ–Ω */
    max-height: 75vh;
  }
  .survey-panel.show {
    right: 0;
  }

  #ai-toggle-btn {
    bottom: 20px;
    right: 20px;
    width: 45px;
    height: 45px;
    font-size: 20px;
  }
}

#ai-toggle-btn:hover {
  background-color: #ff9100;
}

.survey-panel.show {
  right: 0;
}

.survey-panel h3 {
  font-size: 18px;
  color: #333;
  text-align: center;
}

.survey-panel form label {
  margin-bottom: 8px;
  font-size: 13px;
  display: flex;
  flex-direction: column;
  color: #333;
}

.survey-panel form select,
.survey-panel form button {
  padding: 5px;
  font-size: 13px;
  border-radius: 4px;
  border: 1px solid #aaa;
}

.survey-panel form button {
  background-color: #4CAF50;
  color: white;
  font-weight: bold;
  margin-top: 10px;
  cursor: pointer;
}
.survey-panel form button:hover {
  background-color: #45a049;
}

#survey-result {
  margin-top: 10px;
  font-size: 14px;
  font-weight: bold;
}

/* –∑–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∏ */
@media (max-width: 600px) {
  .survey-panel {
    width: 90vw;
    right: -95vw;
  }
  .survey-panel.show {
    right: 0;
  }
  #ai-toggle-btn {
    bottom: 20px;
    right: 20px;
    width: 45px;
    height: 45px;
    font-size: 20px;
  }
}
</style>

<script>
  const surveyPanel = document.getElementById('ai-survey-panel');
  const toggleBtn = document.getElementById('ai-toggle-btn');

  toggleBtn.addEventListener('click', () => {
    surveyPanel.classList.toggle('show');
  });

  // –ü–æ–∫–∞–∑–≤–∞–Ω–µ –Ω–∞ –ø–∞–Ω–µ–ª–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å–ª–µ–¥ 5 —Å–µ–∫—É–Ω–¥–∏
  setTimeout(() => {
    surveyPanel.classList.add('show');
  }, 5000);

  // –ü—Ä–∏ –∏–∑–ø—Ä–∞—â–∞–Ω–µ –Ω–∞ —Ñ–æ—Ä–º–∞—Ç–∞
  document.getElementById('pet-survey-form').addEventListener('submit', function(e) {
    e.preventDefault();
    const resultBox = document.getElementById('survey-result');
    resultBox.textContent = 'üîÑ –ó–∞—Ä–µ–∂–¥–∞–Ω–µ...';

    const formData = new FormData(e.target);
    const userInput = {};
    for (const [key, value] of formData.entries()) {
      userInput[key] = Number(value);
    }

    fetch('/predict', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify(userInput)
    })
    .then(response => response.json())
    .then(data => {
      if (data.recommendation) {
         resultBox.innerHTML = data.recommendation.replace(/\n/g, '<br>');
      } else if (data.error) {
        resultBox.textContent = '‚ö†Ô∏è –ì—Ä–µ—à–∫–∞: ' + data.error;
      }
    });
  });

  // –ù—É–ª–∏—Ä–∞–Ω–µ
  document.getElementById('reset-btn').addEventListener('click', function () {
    document.getElementById('pet-survey-form').reset();
    document.getElementById('survey-result').textContent = '';
  });
</script>


